---
title: PyWebIo åˆä½“éªŒ
description: åœ¨ Github ä¸Šçœ‹åˆ°çš„ä¸€ä¸ªé¡¹ç›®ï¼Œç«Ÿç„¶èƒ½ç”¨ Python å†™ç½‘é¡µï¼å¾ˆæƒ³çŸ¥é“ç°åœ¨è¿˜æœ‰ä»€ä¹ˆæ˜¯ Python å¹²ä¸äº†çš„
pubDate: 2024-08-09
categories:
  - æŠ€æœ¯
tags:
  - Python
  - Pywebio
  - web
image: https://s21.ax1x.com/2024/08/09/pkzbAud.webp
---
## å‰è¨€

å‰ä¸¤å¤©æ­£åœ¨é€› Githubï¼Œå¶ç„¶çœ‹åˆ°ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¡¹ç›®ï¼š**PyWebIo**ã€‚

è¿™æ˜¯ä¸€ä¸ª Python ç¬¬ä¸‰æ–¹åº“ï¼Œå¯ä»¥åªç”¨ Python è¯­è¨€å†™å‡ºä¸€ä¸ªç½‘é¡µï¼Œè€Œä¸”æ”¯æŒ Flaskï¼ŒDjangoï¼ŒTornado ç­‰ web æ¡†æ¶ã€‚

ç”šè‡³ï¼Œå®ƒå¯ä»¥æ”¯æŒæ•°æ®å¯è§†åŒ–å›¾è¡¨çš„ç»˜åˆ¶ï¼Œè¿˜æä¾›äº†ä¸€è¡Œå‡½æ•°æ¸²æŸ“ Markdown æ–‡æœ¬ã€‚

é‚£ä¹ˆè¯ä¸å¤šè¯´ï¼Œæ­£ç‰‡å¼€å§‹â€”â€”

> ä»“åº“åœ°å€ï¼šhttps://github.com/pywebio/PyWebIO

## ä½¿ç”¨æ–¹æ³•

### å®‰è£… Pywebio

æ‰“å¼€ CMDï¼Œåœ¨é‡Œé¢è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š

``` cmd
pip install pywebio
```

å¦‚æœé€Ÿåº¦å¤ªæ…¢ï¼Œå»ºè®®ä½¿ç”¨å›½å†…é•œåƒï¼š

``` cmd
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pywebio
```

### è¾“å‡ºå†…å®¹

- `put_text()` è¾“å‡ºæ–‡å­—
- `put_table()` è¾“å‡ºè¡¨æ ¼
- `put_markdown()` è¾“å‡º markdown å†…å®¹
- `put_file()` è¾“å‡ºæ–‡ä»¶ä¸‹è½½é“¾æ¥
- `put_image()` è¾“å‡ºå›¾ç‰‡
- `put_button()` è¾“å‡ºæŒ‰é’®

è¯·çœ‹å®ä¾‹ç¨‹åºï¼š

``` python
from pywebio.output import *

def main():
Â  Â  # æ–‡æœ¬è¾“å‡º
Â  Â  put_text("Hello world!")
Â  Â  
Â  Â  # è¡¨æ ¼è¾“å‡º
Â  Â  put_table([
Â  Â  Â  Â  ['å•†å“', 'ä»·æ ¼'],
Â  Â  Â  Â  ['è‹¹æœ', '5.5'],
Â  Â  Â  Â  ['é¦™è•‰', '7'],
Â  Â  ])
  
Â  Â  # Markdownè¾“å‡º
Â  Â  put_markdown('~~åˆ é™¤çº¿~~')
  
Â  Â  # æ–‡ä»¶è¾“å‡º
Â  Â  put_file('hello_word.txt', b'hello word!')

if __name__ == '__main__':
Â  Â  main()
```

[![pkzLkTI.png](https://s21.ax1x.com/2024/08/09/pkzLkTI.png)](https://imgse.com/i/pkzLkTI)
### è¾“å…¥å†…å®¹

- `input()` å’Œ python ä¸€æ ·çš„å‡½æ•°æ¬¸

``` python
from pywebio.input import *

def main():
Â  Â  name = input("è¯·è¾“å…¥ä½ çš„åå­—ï¼š")

if __name__ == '__main__':
Â  Â  main()
```

![](https://s3.bmp.ovh/imgs/2024/08/09/9d14cd9c724d3979.gif)
## ç¤ºä¾‹ç¨‹åº

è¿™äº›éƒ½æ˜¯å®˜æ–¹ç»™å‡ºçš„å®ä¾‹ï¼Œä»£ç éƒ½ä¸åˆ° 100 è¡Œï¼

> å®˜æ–¹é¡¹ç›®åœ°å€ï¼š<https://pywebio-demos.pywebio.online/>

### BMI è®¡ç®—å™¨

``` python
from pywebio.input import input, FLOAT
from pywebio.output import put_text
  
def bmi():
Â  Â  height = input("Your Height(cm)ï¼š", type=FLOAT)
Â  Â  weight = input("Your Weight(kg)ï¼š", type=FLOAT)
  
Â  Â  BMI = weight / (height / 100) ** 2
  
Â  Â  top_status = [(14.9, 'Severely underweight'), (18.4, 'Underweight'),
Â  Â  Â  Â  Â  Â  Â  Â  Â  (22.9, 'Normal'), (27.5, 'Overweight'),
Â  Â  Â  Â  Â  Â  Â  Â  Â  (40.0, 'Moderately obese'), (float('inf'), 'Severely obese')]
  
Â  Â  for top, status in top_status:
Â  Â  Â  Â  if BMI <= top:
Â  Â  Â  Â  Â  Â  put_text('Your BMI: %.1f, category: %s' % (BMI, status))
Â  Â  Â  Â  Â  Â  break
  
if __name__ == '__main__':
Â  Â  bmi()
```

![](https://s3.bmp.ovh/imgs/2024/08/09/1c0bf1830daac502.gif)

### Markdown ç¼–è¾‘å™¨

``` python
from pywebio import start_server

from pywebio.output import *
from pywebio.pin import *
from pywebio.session import set_env, download


def main():
    """Markdown Previewer"""
    set_env(output_animation=False)

    put_markdown("""# Markdown Live Preview
    The online markdown editor with live preview. The source code of this application is [here](https://github.com/wang0618/PyWebIO/blob/dev/demos/markdown_previewer.py).
    ## Write your Markdown
    """)
    put_textarea('md_text', rows=18, code={'mode': 'markdown'})

    put_buttons(['Download content'], lambda _: download('saved.md', pin.md_text.encode('utf8')), small=True)

    put_markdown('## Preview')
    while True:
        change_detail = pin_wait_change('md_text')
        with use_scope('md', clear=True):
            put_markdown(change_detail['value'], sanitize=False)


if __name__ == '__main__':
    start_server(main, port=8080, debug=True)
```

![](https://s3.bmp.ovh/imgs/2024/08/09/7442a01e75d51785.gif)

### èŠå¤©å®¤

``` python
import asyncio

from pywebio import start_server
from pywebio.input import *
from pywebio.output import *
from pywebio.session import defer_call, info as session_info, run_async

MAX_MESSAGES_CNT = 10 ** 4

chat_msgs = []  # The chat message history. The item is (name, message content)
online_users = set()


def t(eng, chinese):
    """return English or Chinese text according to the user's browser language"""
    return chinese if 'zh' in session_info.user_language else eng


async def refresh_msg(my_name):
    """send new message to current session"""
    global chat_msgs
    last_idx = len(chat_msgs)
    while True:
        await asyncio.sleep(0.5)
        for m in chat_msgs[last_idx:]:
            if m[0] != my_name:  # only refresh message that not sent by current user
                put_markdown('`%s`: %s' % m, sanitize=True, scope='msg-box')

        # remove expired message
        if len(chat_msgs) > MAX_MESSAGES_CNT:
            chat_msgs = chat_msgs[len(chat_msgs) // 2:]

        last_idx = len(chat_msgs)


async def main():
    """PyWebIO chat room

    You can chat with everyone currently online.
    """
    global chat_msgs

    put_markdown(t("## PyWebIO chat room\nWelcome to the chat room, you can chat with all the people currently online. You can open this page in multiple tabs of your browser to simulate a multi-user environment. This application uses less than 90 lines of code, the source code is [here](https://github.com/wang0618/PyWebIO/blob/dev/demos/chat_room.py)", "## PyWebIOèŠå¤©å®¤\næ¬¢è¿æ¥åˆ°èŠå¤©å®¤ï¼Œä½ å¯ä»¥å’Œå½“å‰æ‰€æœ‰åœ¨çº¿çš„äººèŠå¤©ã€‚ä½ å¯ä»¥åœ¨æµè§ˆå™¨çš„å¤šä¸ªæ ‡ç­¾é¡µä¸­æ‰“å¼€æœ¬é¡µé¢æ¥æµ‹è¯•èŠå¤©æ•ˆæœã€‚æœ¬åº”ç”¨ä½¿ç”¨ä¸åˆ°90è¡Œä»£ç å®ç°ï¼Œæºä»£ç [é“¾æ¥](https://github.com/wang0618/PyWebIO/blob/dev/demos/chat_room.py)"))

    put_scrollable(put_scope('msg-box'), height=300, keep_bottom=True)
    nickname = await input(t("Your nickname", "è¯·è¾“å…¥ä½ çš„æ˜µç§°"), required=True, validate=lambda n: t('This name is already been used', 'æ˜µç§°å·²è¢«ä½¿ç”¨') if n in online_users or n == 'ğŸ“¢' else None)

    online_users.add(nickname)
    chat_msgs.append(('ğŸ“¢', '`%s` joins the room. %s users currently online' % (nickname, len(online_users))))
    put_markdown('`ğŸ“¢`: `%s` join the room. %s users currently online' % (nickname, len(online_users)), sanitize=True, scope='msg-box')

    @defer_call
    def on_close():
        online_users.remove(nickname)
        chat_msgs.append(('ğŸ“¢', '`%s` leaves the room. %s users currently online' % (nickname, len(online_users))))

    refresh_task = run_async(refresh_msg(nickname))

    while True:
        data = await input_group(t('Send message', 'å‘é€æ¶ˆæ¯'), [
            input(name='msg', help_text=t('Message content supports inline Markdown syntax', 'æ¶ˆæ¯å†…å®¹æ”¯æŒè¡Œå†…Markdownè¯­æ³•')),
            actions(name='cmd', buttons=[t('Send', 'å‘é€'), t('Multiline Input', 'å¤šè¡Œè¾“å…¥'), {'label': t('Exit', 'é€€å‡º'), 'type': 'cancel'}])
        ], validate=lambda d: ('msg', 'Message content cannot be empty') if d['cmd'] == t('Send', 'å‘é€') and not d['msg'] else None)
        if data is None:
            break
        if data['cmd'] == t('Multiline Input', 'å¤šè¡Œè¾“å…¥'):
            data['msg'] = '\n' + await textarea('Message content', help_text=t('Message content supports Markdown syntax', 'æ¶ˆæ¯å†…å®¹æ”¯æŒMarkdownè¯­æ³•'))
        put_markdown('`%s`: %s' % (nickname, data['msg']), sanitize=True, scope='msg-box')
        chat_msgs.append((nickname, data['msg']))

    refresh_task.close()
    toast("You have left the chat room")


if __name__ == '__main__':
    start_server(main, debug=True)
```

![](https://s3.bmp.ovh/imgs/2024/08/09/776c6b7fc30f2b8c.gif)

### äº”å­æ£‹

``` python
import time

from pywebio import session, start_server
from pywebio.output import *

goboard_size = 15
# -1 -> none, 0 -> black, 1 -> white
goboard = [
    [-1] * goboard_size
    for _ in range(goboard_size)
]


def winner():  # return winner piece, return None if no winner
    for x in range(2, goboard_size - 2):
        for y in range(2, goboard_size - 2):
            # check if (x,y) is the win center
            if goboard[x][y] != -1 and any([
                all(goboard[x][y] == goboard[m][n] for m, n in [(x - 2, y), (x - 1, y), (x + 1, y), (x + 2, y)]),
                all(goboard[x][y] == goboard[m][n] for m, n in [(x, y - 2), (x, y - 1), (x, y + 1), (x, y + 2)]),
                all(goboard[x][y] == goboard[m][n] for m, n in [(x - 2, y - 2), (x - 1, y - 1), (x + 1, y + 1), (x + 2, y + 2)]),
                all(goboard[x][y] == goboard[m][n] for m, n in [(x - 2, y + 2), (x - 1, y + 1), (x + 1, y - 1), (x + 2, y - 2)]),
            ]):
                return ['âš«', 'âšª'][goboard[x][y]]


session_id = 0          # auto incremented id for each session
current_turn = 0        # 0 for black, 1 for white
player_count = [0, 0]   # count of player for two roles


def main():
    """Online Shared Gomoku Game

    A web based Gomoku (AKA GoBang, Five in a Row) game made with PyWebIO under 100 lines of Python code."""
    global session_id, current_turn, goboard
    if winner():  # The current game is over, reset game
        goboard = [[-1] * goboard_size for _ in range(goboard_size)]
        current_turn = 0

    my_turn = session_id % 2
    my_chess = ['âš«', 'âšª'][my_turn]
    session_id += 1
    player_count[my_turn] += 1

    @session.defer_call
    def player_exit():
        player_count[my_turn] -= 1

    session.set_env(output_animation=False)
    put_html("""<style> table th, table td { padding: 0px !important;} button {padding: .75rem!important; margin:0!important} </style>""")  # Custom styles to make the board more beautiful

    put_markdown(f"""# Online Shared Gomoku Game
    All online players are assigned to two groups (black and white) and share this game. You can open this page in multiple tabs of your browser to simulate multiple users. This application uses less than 100 lines of code, the source code is [here](https://github.com/wang0618/PyWebIO/blob/dev/demos/gomoku_game.py)
    Currently online player: {player_count[0]} for âš«, {player_count[1]} for âšª. Your role is {my_chess}.
    """)

    def set_stone(pos):
        global current_turn
        if current_turn != my_turn:
            toast("It's not your turn!!", color='error')
            return
        x, y = pos
        goboard[x][y] = my_turn
        current_turn = (current_turn + 1) % 2

    @use_scope('goboard', clear=True)
    def show_goboard():
        table = [
            [
                put_buttons([dict(label=' ', value=(x, y), color='light')], onclick=set_stone) if cell == -1 else [' âš«', ' âšª'][cell]
                for y, cell in enumerate(row)
            ]
            for x, row in enumerate(goboard)
        ]
        put_table(table)

    show_goboard()
    while not winner():
        with use_scope('msg', clear=True):
            current_turn_copy = current_turn
            if current_turn_copy == my_turn:
                put_text("It's your turn!")
            else:
                put_row([put_text("Your opponent's turn, waiting... "), put_loading().style('width:1.5em; height:1.5em')], size='auto 1fr')
            while current_turn == current_turn_copy and not session.get_current_session().closed():  # wait for next move
                time.sleep(0.2)
            show_goboard()
    with use_scope('msg', clear=True):
        put_text('Game over. The winner is %s!\nRefresh page to start a new round.' % winner())


if __name__ == '__main__':
    start_server(main, debug=True, port=8080)
```

![](https://s3.bmp.ovh/imgs/2024/08/09/7a1ca8942884619f.gif)

---
ç¨å¾®è¯•äº†è¯•è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œæ„Ÿè§‰åŠŸèƒ½ååˆ†çš„å¼ºå¤§ã€‚

ä¸åªæ˜¯ä¸Šé¢çš„é¡¹ç›®ï¼Œå®ƒè¿˜æœ‰ä¸åŒé£æ ¼ï¼Œèƒ½ç»˜åˆ¶ä¸åŒå›¾è¡¨ï¼Œé›†æˆwebæ¡†æ¶ã€‚

æœ‰äº†è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾åœ°å°† Python ç¨‹åºå±•ç¤ºåœ¨ç½‘é¡µä¸Šï¼Œä¹Ÿå°±æ˜¯å®ç°ä½¿ç”¨ Python å¼€å‘å‰ç«¯ï¼

æœ¬æ–‡å°±åˆ°è¿™é‡Œï¼Œæ‹œ~

